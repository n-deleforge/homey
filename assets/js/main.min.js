const version=1.5,GithubLink='<a href="https://github.com/n-deleforge/homey" target="_blank">GitHub</a>',ndLink='<a href="https://nicolas-deleforge.fr" target="_blank">nd</a>';/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&(get("#container").style.minHeight=window.outerHeight+"px"),storage("get","HOMEY-settings")?settings=JSON.parse(storage("get","HOMEY-settings")):(settings={core:{start:!1,version:1.2},profile:{name:"",theme:"dark"},weather:{activated:"",api:"",town:""},note:{activated:!1,content:""}},storage("set","HOMEY-settings",JSON.stringify(settings)));const FR={start:{startTitle:"Bienvenue sur Homey !",startP1:"Avant tout, sache que si tu utilises cette application, certaines de tes donn√©es seront stock√©es sur ton appareil (et UNIQUEMENT sur ton appareil).<br />En utilisant Homey, tu confirmes avoir pris connaissance de ce fait. Aucune donn√©e n'est partag√©e avec un tiers.",startP2:"Si c'est ta premi√®re visite alors il faut configurer l'appli. Cela ne prendra que quelques secondes.",startP3:"Par contre, si tu as d√©j√† utilis√© l'application, tu peux importer tes donn√©es.",displayInitMenu:"Configuration",displayImportMenu:"Importation"},initMenu:{initMenuTitle:"Initialisation",initMenuLabel:"Pr√©nom / surnom",initMenuCheck:"Ton pr√©nom doit √™tre compos√© entre 2 √† 15 caract√®res.",confirmInitMenu:"Confirmer",closeInitMenu:"Annuler"},importMenu:{importMenuTitle:"Importation",importMenuLabel:"Sauvegarde",importMenuCheck:'Le fichier de sauvegarde s\'appellement normalement "homey.json".',importMenuConfirm:"Confirmer",closeImportMenu:"Annuler"},listSettings:{settingsTitle:"Param√®tres",displayProfilMenu:"üôÇ Profil",displayWeatherMenu:"‚õÖ M√©t√©o",displayAppsMenu:"üß© Applications",switchTheme:"üåà Changer de th√®me",exportData:"üì≤ Exportation des donn√©es",displayLogoutMenu:"üö´ D√©connexion"},logoutMenu:{logoutMenuTitle:"D√©connexion",logoutMenuText:"Cette action va entrainer la suppression de toutes les donn√©es et la r√©initialisation de l'application.",logoutMenuConfirm:"Confirmer",closeLogoutMenu:"Annuler"},profileMenu:{profilMenuTitle:"Profil",profilMenuLabel:"Pr√©nom / surnom",profilMenuCheck:"Ton pr√©nom doit √™tre compos√© entre 2 √† 15 caract√®res.",profilMenuConfirm:"Appliquer et fermer"},weatherMenu:{weatherMenuTitle:"M√©t√©o",weatherMenuActivate:"Activer",weatherMenuAPILabel:"Cl√© API",weatherMenuTownLebel:"Ville",weatherMenuCheck:"Les deux champs sont n√©cessaires. OpenWeather fournit une cl√© API gratuitement.",weatherMenuConfirm:"Appliquer et fermer"},appsMenu:{appsMenuTitle:"Applications",appsMenuContent:"Vous pouvez activer ou d√©sactiver les applications.",appsMenuLabelNotes:"Notes",closeAppsMenu:"Appliquer et fermer"},misc:{footer:"Disponible sur "+GithubLink+" (v 1.5) - H√©berg√© sur  "+ndLink},etc:{dateLanguage:"fr-FR",weatherLanguage:"FR",errorImport:"Le fichier est incorrect. R√©essayer."}},EN={start:{startTitle:"Welcome to Homey !",startP1:"Before anything else, you have to know that if you use this application, some of your data will be saved on your device (and ONLY on your device).<br /> In using Homey, your confirm that you understand and agree of that. No data is shared with a third party.",startP2:"If it's your first visit then you need to configure the application. It will only take a few seconds.",startP3:"However, if you already have used the application, you can import your data.",displayInitMenu:"Configure",displayImportMenu:"Import"},initMenu:{initMenuTitle:"Start",initMenuLabel:"Name / nickname",initMenuCheck:"Your name must be composed between 2 to 15 characters.",confirmInitMenu:"Confirm",closeInitMenu:"Cancel"},importMenu:{importMenuTitle:"Import",importMenuLabel:"Filesave",importMenuCheck:'The file is normally called "homey.json".',importMenuConfirm:"Confirm",closeImportMenu:"Cancel"},listSettings:{settingsTitle:"Settings",displayProfilMenu:"üôÇ Profile",displayWeatherMenu:"‚õÖ Weather",displayAppsMenu:"üß© Applications",switchTheme:"üåà Switch theme",exportData:"üì≤ Export data",displayLogoutMenu:"üö´ Logout"},logoutMenu:{logoutMenuTitle:"Deconnection",logoutMenuText:"This action will delete all the data of the application.",logoutMenuConfirm:"Confirm",closeLogoutMenu:"Cancel"},profileMenu:{profilMenuTitle:"Profile",profilMenuLabel:"Name / nickname",profilMenuCheck:"Your name must be composed between 2 to 15 characters.",profilMenuConfirm:"Confirm and close"},weatherMenu:{weatherMenuTitle:"Weather",weatherMenuActivate:"Activate",weatherMenuAPILabel:"API OpenWeather",weatherMenuTownLebel:"Town",weatherMenuCheck:"The two fields are required.",weatherMenuConfirm:"Confirm and close"},appsMenu:{appsMenuTitle:"Applications",appsMenuContent:"You can activate or desactive apps here.",appsMenuLabelNotes:"Notes",closeAppsMenu:"Confirm and close"},misc:{footer:"Available on "+GithubLink+" (v 1.5) - Hosted on "+ndLink,noteTitle:"My notes"},etc:{dateLanguage:"en-EN",weatherLanguage:"EN",errorImport:"The file is incorrect. Try again."}};"fr"==navigator.language||"fr-FR"==navigator.language?(display=FR,get("#htmlTag").lang="fr"):(display=EN,get("#htmlTag").lang="en");for(let e=0;e<Object.keys(display).length-1;e++){let t=display[Object.keys(display)[e]],n=Object.keys(t),i=Object.values(t);for(let e=0;e<n.length;e++)get("#"+n[e]).innerHTML=i[e]}if(0==settings.core.start){get("#start").style.display="flex";for(let e=0;e<get("~input").length;e++)get("~input")[e].value="";for(let e=0;e<get("~textarea").length;e++)get("~textarea")[e].value=""}else displayApp(),displayWeatherInfo();function displayApp(){document.title="HOMEY - "+settings.profile.name,displayTime(),setInterval(displayTime,3e4),get("#start").style.display="none",get("#app").style.display="flex","dark"==settings.profile.theme?displayTheme("dark"):"light"==settings.profile.theme&&displayTheme("light"),""!=settings.weather.api&&(get("#weatherMenuAPIValue").value=settings.weather.api),""!=settings.weather.town&&(get("#weatherMenuTownValue").value=settings.weather.town),1==settings.weather.activated?(get("#activateWeather").checked=!0,get("#weatherMenuAPI").style.display="flex",get("#weatherMenuTown").style.display="flex",get("#weatherMenuCheck").style.display="block"):(get("#activateWeather").checked=!1,get("#weatherMenuAPI").style.display="none",get("#weatherMenuTown").style.display="none",get("#weatherMenuCheck").style.display="none"),1==settings.note.activated?(get("#activateNote").checked=!0,get("#displayNote").style.display="block"):(get("#activateNote").checked=!1,get("#displayNote").style.display="none"),get("#noteContainer").style.visibility="hidden"}function displayTime(){let e=new Date,t=e.toLocaleString(display.etc.dateLanguage,{weekday:"long",month:"long",day:"numeric"}),n=e.getHours(),i=e.getMinutes();n<10&&(n="0"+n),i<10&&(i="0"+i),get("#displayTime").innerHTML=n+":"+i,get("#displayDate").innerHTML=t}function displayWeatherInfo(){1==settings.weather.activated&&""!=settings.weather.api&&""!=settings.weather.town?(requestWeather(),setInterval(requestWeather,18e5)):get("#displayWeather").innerHTML=""}function requestWeather(){const e=new XMLHttpRequest;e.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){if(200===this.status){let e=JSON.parse(this.responseText);console.log("Weather requested");let t,n=new Date;if(n.getHours()<7||n.getHours()>19)t="üåô";else switch(e.weather[0].main){case"Thunderstorm":t="üå©";case"Drizzle":t="üå®";case"Rain":t="üåß";case"Snow":t="üå®";case"Atmosphere":t="üå™";case"Clear":t="‚òÄ";case"Clouds":t="‚õÖ"}get("#displayWeather").innerHTML=t+" "+Math.round(e.main.temp)+" <sup>¬∞c</sup>"}}else get("#displayWeather").innerHTML="‚ùó"},e.open("GET","https://api.openweathermap.org/data/2.5/weather?q="+settings.weather.town+"&appid="+settings.weather.api+"&lang="+display.etc.weatherLanguage+"&units=metric",!0),e.send(null)}function changeDisplay(e){"app"==e?(get("#time").style.justifyContent="flex-start",get("#time").style.fontSize="1em",get("#time").style.flexGrow="0",get("#containerApps").style.display="flex",get("#containerApps").style.flexGrow="1",/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&1==settings.weather.activated&&(get("#displayWeather").style.display="none")):(get("#time").style.justifyContent="center",get("#time").style.fontSize="2em",get("#time").style.flexGrow="1",get("#containerApps").style.display="none",get("#containerApps").style.flexGrow="0",/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&1==settings.weather.activated&&(get("#displayWeather").style.display="block"))}function displayNoteApp(e){""!=settings.note.content&&(get("#note").value=settings.note.content),get("#note").addEventListener("change",function(){settings.note.content=get("#note").value,updateJSON()}),"forceClose"==e?(changeDisplay("normal"),get("#noteContainer").style.visibility="hidden"):"hidden"==get("#noteContainer").style.visibility?(changeDisplay("app"),get("#noteContainer").style.visibility="visible",get("#note").focus()):(changeDisplay("normal"),get("#noteContainer").style.visibility="hidden")}function switchTheme(){switch(settings.profile.theme){case"dark":displayTheme("light"),settings.profile.theme="light",updateJSON();break;case"light":displayTheme("dark"),settings.profile.theme="dark",updateJSON()}}function displayTheme(e){"dark"==e&&(get("#theme").href="assets/css/theme-dark.min.css"),"light"==e&&(get("#theme").href="assets/css/theme-light.min.css")}function updateJSON(){storage("set","HOMEY-settings",JSON.stringify(settings))}function openWindow(e){get("#containerPopup").style.display="flex",get("#"+e).style.display="block"}function closeWindow(){get("#containerPopup").style.display="none";for(let e=0;e<get("#containerPopup").children.length;e++)get("#containerPopup").children[e].style.display="none"}function get(e){return 0==e.search("#")&&null!=e.split("#")[1]&&null!=document.querySelector(e)?document.querySelector(e):0==e.search(".")&&null!=e.split(".")[1]&&null!=document.querySelectorAll(e)?document.querySelectorAll(e):0==e.search("~")&&null!=e.split("~")[1]&&null!=document.querySelectorAll(e.split("~")[1])?document.querySelectorAll(e.split("~")[1])[0]:void 0}function storage(e,t,n){return"get"==e?localStorage.getItem(t):"set"==e?localStorage.setItem(t,n):"rem"==e?localStorage.removeItem(t):void 0}function ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}function download(e,t){let n=new Blob([e],{type:"text/plain"}),i=document.createElement("a");i.download=t,i.href=window.URL.createObjectURL(n),i.click()}get("#displayInitMenu").addEventListener("click",function(){openWindow("initMenu"),get("#closeInitMenu").addEventListener("click",closeWindow),get("#confirmInitMenu").addEventListener("click",function(){get("#name").checkValidity()&&""!=get("#name").value?(settings.core.start=!0,settings.profile.activated=!0,settings.profile.name=get("#name").value,updateJSON(),displayApp(),displayWeatherInfo(),closeWindow()):get("#initMenuCheck").style.color="red"})}),get("#displayImportMenu").addEventListener("click",function(){openWindow("importMenu"),get("#closeImportMenu").addEventListener("click",closeWindow),get("#importMenuConfirm").addEventListener("click",function(){if(0!=get("#importData").files.length){let e=new FileReader;e.readAsText(get("#importData").files[0]),e.onload=function(e){let t=atob(e.target.result);settings=JSON.parse(t),updateJSON(),location.reload()}}else get("#importMenuCheck").innerHTML=display.etc.errorImport,get("#importMenuCheck").style.color="red"})}),get("#displaySettings").addEventListener("click",function(){closeWindow(),displayNoteApp("forceClose"),get("#displaySettings").style.display="none",get("#listSettings").style.animation="fadeInRight",get("#listSettings").style.animationDuration="0.5s",get("#listSettings").style.display="flex"}),get("#closeSettings").addEventListener("click",function(){get("#displaySettings").style.display="block",get("#listSettings").style.display="none"}),get("#displayNote").addEventListener("click",displayNoteApp),get("#exportData").addEventListener("click",function(){download(btoa(JSON.stringify(settings)),"homey.json")}),get("#switchTheme").addEventListener("click",switchTheme),get("#displayAppsMenu").addEventListener("click",function(){openWindow("appsMenu"),get("#closeAppsMenu").addEventListener("click",closeWindow),get("#activateNote").addEventListener("click",function(){1==get("#activateNote").checked?settings.note.activated=!0:settings.note.activated=!1,updateJSON(),displayApp()}),get("#activateTheme").addEventListener("click",function(){1==get("#activateTheme").checked?settings.theme.activated=!0:settings.theme.activated=!1,updateJSON(),displayApp()})}),get("#displayLogoutMenu").addEventListener("click",function(){openWindow("logoutMenu"),get("#closeLogoutMenu").addEventListener("click",closeWindow),get("#logoutMenuConfirm").addEventListener("click",function(){storage("rem","HOMEY-settings"),location.reload()})}),get("#displayProfilMenu").addEventListener("click",function(){openWindow("profilMenu"),get("#newName").value=settings.profile.name,get("#profilMenuConfirm").addEventListener("click",function(){get("#newName").checkValidity()&&""!=get("#newName").value?(get("#profilMenuCheck").style.color="white",settings.profile.name=get("#newName").value,updateJSON(),displayApp(),closeWindow()):get("#profilMenuCheck").style.color="red"})}),get("#displayWeatherMenu").addEventListener("click",function(){openWindow("weatherMenu"),get("#weatherMenuAPIValue").addEventListener("input",function(){settings.weather.api=get("#weatherMenuAPIValue").value,updateJSON()}),get("#weatherMenuTownValue").addEventListener("input",function(){settings.weather.town=get("#weatherMenuTownValue").value,updateJSON()}),get("#weatherMenuConfirm").addEventListener("click",function(){1==settings.weather.activated?""!=settings.weather.api&&""!=settings.weather.town?(get("#weatherMenuCheck").style.color="white",displayWeatherInfo(),closeWindow()):get("#weatherMenuCheck").style.color="red":(settings.weather.activated=!1,updateJSON(),displayWeatherInfo(),closeWindow())}),get("#activateWeather").addEventListener("change",function(){1==get("#activateWeather").checked?settings.weather.activated=!0:settings.weather.activated=!1,updateJSON(),displayApp()})});